<?xml version="1.0" encoding="UTF-8"?>
<module name="vyatta-security-firewall"
        xmlns="urn:ietf:params:xml:ns:yang:yin:1"
        xmlns:security-firewall="urn:vyatta.com:mgmt:vyatta-security-firewall"
        xmlns:if="urn:vyatta.com:mgmt:vyatta-interfaces"
        xmlns:interfaces-bridge="urn:vyatta.com:mgmt:vyatta-interfaces-bridge"
        xmlns:interfaces-dataplane="urn:vyatta.com:mgmt:vyatta-interfaces-dataplane"
        xmlns:interfaces-l2tpeth="urn:vyatta.com:mgmt:vyatta-interfaces-l2tpeth"
        xmlns:interfaces-openvpn="urn:vyatta.com:mgmt:vyatta-interfaces-openvpn"
        xmlns:interfaces-tunnel="urn:vyatta.com:mgmt:vyatta-interfaces-tunnel"
        xmlns:interfaces-vti="urn:vyatta.com:mgmt:vyatta-interfaces-vti"
        xmlns:security="urn:vyatta.com:mgmt:vyatta-security"
        xmlns:configd="urn:vyatta.com:mgmt:configd">
  <namespace uri="urn:vyatta.com:mgmt:vyatta-security-firewall"/>
  <prefix value="security-firewall"/>
  <import module="vyatta-interfaces">
    <prefix value="if"/>
  </import>
  <import module="vyatta-interfaces-bridge">
    <prefix value="interfaces-bridge"/>
  </import>
  <import module="vyatta-interfaces-dataplane">
    <prefix value="interfaces-dataplane"/>
  </import>
  <import module="vyatta-interfaces-l2tpeth">
    <prefix value="interfaces-l2tpeth"/>
  </import>
  <import module="vyatta-interfaces-openvpn">
    <prefix value="interfaces-openvpn"/>
  </import>
  <import module="vyatta-interfaces-tunnel">
    <prefix value="interfaces-tunnel"/>
  </import>
  <import module="vyatta-interfaces-vti">
    <prefix value="interfaces-vti"/>
  </import>
  <import module="vyatta-security">
    <prefix value="security"/>
  </import>
  <import module="configd">
    <prefix value="configd"/>
  </import>
  <organization>
    <text>Brocade Communications Systems, Inc.</text>
  </organization>
  <contact>
    <text>Brocade Communications Systems, Inc.
Postal: 130 Holger Way
 San Jose, CA 95134
E-mail: support@Brocade.com
Web: www.brocade.com</text>
  </contact>
  <revision date="2014-11-07">
    <description>
      <text>Update for 3.2.1R2</text>
    </description>
  </revision>
  <revision date="2014-10-28">
    <description>
      <text>Update for 3.2.1R1</text>
    </description>
  </revision>
  <revision date="2014-08-27">
    <description>
      <text>Initial revision.</text>
    </description>
    <configd:migration level="1"/>
  </revision>
  <typedef name="bandwidth-suffix">
    <type name="string">
      <pattern value="[0-9]+(\.([0-9]+))?(([KMBGTkmgt][iI]?)?(bit|bps))?"/>
      <configd:pattern-help text="&lt;number&gt;&lt;suffix&gt;"/>
    </type>
  </typedef>
  <grouping name="marking">
    <container name="mark">
      <configd:help text="Packet marking action"/>
      <leaf name="dscp">
        <type name="uint8">
          <range value="0..63"/>
        </type>
        <configd:help text="DSCP value to be marked"/>
      </leaf>
      <leaf name="pcp">
        <type name="uint8">
          <range value="0..7"/>
        </type>
        <configd:help text="802.1 priority code point to apply"/>
      </leaf>
    </container>
  </grouping>
  <augment target-node="/security:security">
    <container name="firewall">
      <presence value="true"/>
      <configd:priority priority="310"/>
      <configd:help text="Firewall"/>
      <configd:begin executable="/opt/vyatta/share/tmplscripts/security/firewall/configd_begin.sh"/>
      <configd:end executable="/opt/vyatta/share/tmplscripts/security/firewall/configd_end.sh"/>
      <leaf name="tcp-strict">
        <type name="empty"/>
        <configd:help text="Enable tcp strict stateful firewall rule"/>
        <configd:create executable="/opt/vyatta/share/tmplscripts/security/firewall/tcp-strict/configd_create.sh"/>
        <configd:delete executable="/opt/vyatta/share/tmplscripts/security/firewall/tcp-strict/configd_delete.sh"/>
        <configd:end executable="/opt/vyatta/share/tmplscripts/security/firewall/tcp-strict/configd_end.sh"/>
      </leaf>
      <leaf name="broadcast-ping">
        <type name="enumeration">
          <enum name="enable"/>
          <enum name="disable"/>
        </type>
        <configd:help text="Policy for handling broadcast IPv4 ICMP echo requests"/>
        <default value="disable"/>
        <configd:update executable="/opt/vyatta/share/tmplscripts/security/firewall/broadcast-ping/configd_update.sh"/>
        <configd:delete executable="/opt/vyatta/share/tmplscripts/security/firewall/broadcast-ping/configd_delete.sh"/>
      </leaf>
      <leaf name="all-ping">
        <type name="enumeration">
          <enum name="enable"/>
          <enum name="disable"/>
        </type>
        <configd:help text="Policy for handling of all IPv4 ICMP echo requests"/>
        <default value="enable"/>
        <configd:update executable="/opt/vyatta/share/tmplscripts/security/firewall/all-ping/configd_update.sh"/>
        <configd:delete executable="/opt/vyatta/share/tmplscripts/security/firewall/all-ping/configd_delete.sh"/>
      </leaf>
      <leaf name="syn-cookies">
        <type name="enumeration">
          <enum name="enable"/>
          <enum name="disable"/>
        </type>
        <configd:help text="Policy for using TCP SYN cookies with IPv4"/>
        <configd:update executable="/opt/vyatta/share/tmplscripts/security/firewall/syn-cookies/configd_update.sh"/>
        <configd:delete executable="/opt/vyatta/share/tmplscripts/security/firewall/syn-cookies/configd_delete.sh"/>
      </leaf>
      <list name="name">
        <configd:help text="Firewall group"/>
        <configd:delete executable="/opt/vyatta/share/tmplscripts/security/firewall/name/configd_delete.sh"/>
        <configd:end executable="/opt/vyatta/share/tmplscripts/security/firewall/name/configd_end.sh"/>
        <key value="tagnode"/>
        <leaf name="tagnode">
          <type name="string">
            <pattern value="[0-9A-Za-z][-_0-9A-Za-z]*">
              <error-message>
                <value>only alpha-numeric policy name allowed</value>
              </error-message>
            </pattern>
          </type>
          <configd:help text="Firewall group"/>
        </leaf>
        <leaf name="description">
          <type name="string"/>
          <configd:help text="Rule-set description"/>
        </leaf>
        <list name="rule">
          <configd:help text="Rule number (1-9999)"/>
          <configd:validate executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/configd_validate1.cli"/>
          <key value="tagnode"/>
          <leaf name="tagnode">
            <type name="uint32">
              <range value="1..9999"/>
            </type>
            <configd:help text="Rule number (1-9999)"/>
          </leaf>
          <container name="tcp">
            <presence value="true"/>
            <configd:help text="TCP flags to match"/>
            <configd:validate executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/tcp/configd_validate1.cli"/>
            <leaf name="flags">
              <type name="string">
                <pattern value="(((!?(SYN|ACK|FIN|RST|PSH|URG),)*(!?(SYN|ACK|FIN|RST|PSH|URG))))">
                  <error-message>
                    <value>Invalid value for TCP flags. Allowed values : SYN ACK FIN RST URG PSH
When specifying more than one flag, flags should be comma-separated.
For example : value of 'SYN,!ACK,!FIN,!RST' will only match packets with
the SYN flag set, and the ACK, FIN and RST flags unset</value>
                  </error-message>
                </pattern>
              </type>
              <configd:help text="TCP flags to match"/>
              <configd:comp_help text="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/tcp/flags/configd_comp_help.txt"/>
            </leaf>
          </container>
          <container name="ipv6-route">
            <presence value="true"/>
            <configd:help text="IPv6 route"/>
            <configd:validate executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/ipv6-route/configd_validate1.cli"/>
            <leaf name="type">
              <type name="uint8">
                <range value="0..255"/>
              </type>
              <configd:help text="IPv6 route type must be between 0 and 255"/>
            </leaf>
          </container>
          <container name="icmp">
            <presence value="true"/>
            <configd:help text="ICMP for IPV4"/>
            <configd:validate executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/icmp/configd_validate1.cli"/>
            <leaf name="type-name">
              <type name="string">
                <configd:syntax executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/icmp/type-name/configd_syntax1.cli"/>
              </type>
              <configd:help text="ICMP type-name"/>
              <configd:allowed executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/icmp/type-name/configd_allowed.sh"/>
            </leaf>
            <leaf name="code">
              <type name="uint8">
                <range value="0..255"/>
              </type>
              <configd:help text="ICMP code must be between 0 and 255"/>
              <configd:validate executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/icmp/code/configd_validate1.cli"/>
              <configd:validate executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/icmp/code/configd_validate2.cli"/>
            </leaf>
            <leaf name="type">
              <type name="uint8">
                <range value="0..255"/>
              </type>
              <configd:help text="ICMP type must be between 0 and 255"/>
              <configd:validate executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/icmp/type/configd_validate1.cli"/>
              <configd:validate executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/icmp/type/configd_validate2.cli"/>
            </leaf>
          </container>
          <leaf name="description">
            <type name="string"/>
            <configd:help text="Rule description"/>
          </leaf>
          <leaf name="action">
            <type name="enumeration">
              <enum name="accept"/>
              <enum name="drop"/>
            </type>
            <configd:help text="Rule action"/>
          </leaf>
          <uses name="marking"/>
          <leaf name="disable">
            <type name="empty"/>
            <configd:help text="Disable firewall rule"/>
            <configd:create executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/disable/configd_create.sh"/>
            <configd:delete executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/disable/configd_delete.sh"/>
          </leaf>
          <leaf name="pcp">
            <type name="uint8">
              <range value="0..7"/>
            </type>
            <configd:help text="802.1 priority code point to match (0 to 7)"/>
          </leaf>
          <container name="police">
            <configd:help text="Packet rate limiting"/>
            <configd:validate executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/police/configd_validate.cli"/>
            <leaf name="bandwidth">
              <type name="bandwidth-suffix"/>
              <configd:help text="Bandwidth limit"/>
            </leaf>
            <leaf name="burst">
              <type name="uint32">
                <range value="1..312500000"/>
              </type>
              <configd:help text="Burst size in bytes"/>
            </leaf>
            <container name="then">
              <configd:help text="Result for packets over police limit"/>
              <leaf name="action">
                <type name="enumeration">
                  <enum name="drop">
                    <configd:help text="Drop if overlimit"/>
                  </enum>
                  <enum name="accept">
                    <configd:help text="Accept if overlimit"/>
                  </enum>
                </type>
                <configd:help text="Police action"/>
              </leaf>
              <uses name="marking"/>
            </container>
          </container>
          <leaf name="fragment">
            <type name="empty"/>
            <configd:help text="Match on fragmented packets"/>
          </leaf>
          <container name="icmpv6">
            <presence value="true"/>
            <configd:help text="ICMP for IPV6"/>
            <configd:validate executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/icmpv6/configd_validate1.cli"/>
            <leaf name="type-name">
              <type name="string">
                <configd:syntax executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/icmpv6/type-name/configd_syntax1.cli"/>
              </type>
              <configd:help text="ICMPv6 type/code names"/>
              <configd:allowed executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/icmpv6/type-name/configd_allowed.sh"/>
            </leaf>
            <leaf name="code">
              <type name="uint8">
                <range value="0..255"/>
              </type>
              <configd:help text="ICMP code must be between 0 and 255"/>
              <configd:validate executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/icmpv6/code/configd_validate1.cli"/>
              <configd:validate executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/icmpv6/code/configd_validate2.cli"/>
            </leaf>
            <leaf name="type">
              <type name="uint8">
                <range value="0..255"/>
              </type>
              <configd:help text="ICMP type must be between 0 and 255"/>
              <configd:validate executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/icmpv6/type/configd_validate1.cli"/>
              <configd:validate executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/icmpv6/type/configd_validate2.cli"/>
            </leaf>
          </container>
          <container name="source">
            <presence value="true"/>
            <configd:help text="Source parameters"/>
            <leaf name="mac-address">
              <type name="string">
                <configd:syntax executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/source/mac-address/configd_syntax1.cli"/>
              </type>
              <configd:help text="Source MAC address"/>
              <configd:validate executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/source/mac-address/configd_validate1.cli"/>
              <configd:validate executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/source/mac-address/configd_validate2.cli"/>
            </leaf>
            <leaf name="address">
              <type name="string">
                <configd:syntax executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/source/address/configd_syntax1.cli"/>
                <configd:syntax executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/source/address/configd_syntax2.cli"/>
              </type>
              <configd:help text="Source IP address, subnet, or address-group"/>
              <configd:allowed executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/source/address/configd_allowed.sh"/>
              <configd:validate executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/source/address/configd_validate1.cli"/>
              <configd:validate executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/source/address/configd_validate2.cli"/>
              <configd:validate executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/source/address/configd_validate3.cli"/>
              <configd:validate executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/source/address/configd_validate4.cli"/>
              <configd:validate executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/source/address/configd_validate5.cli"/>
              <configd:validate executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/source/address/configd_validate6.cli"/>
            </leaf>
            <leaf name="port">
              <type name="string"/>
              <configd:help text="Source port or port-group"/>
              <configd:allowed executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/source/port/configd_allowed.sh"/>
              <configd:validate executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/source/port/configd_validate1.cli"/>
              <configd:validate executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/source/port/configd_validate2.cli"/>
            </leaf>
          </container>
          <leaf name="log">
            <type name="empty"/>
            <configd:help text="Enable logging for Firewall rule"/>
          </leaf>
          <container name="destination">
            <presence value="true"/>
            <configd:help text="Destination parameters"/>
            <leaf name="mac-address">
              <type name="string">
                <configd:syntax executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/destination/mac-address/configd_syntax1.cli"/>
              </type>
              <configd:help text="Destination MAC address"/>
              <configd:validate executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/destination/mac-address/configd_validate1.cli"/>
              <configd:validate executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/destination/mac-address/configd_validate2.cli"/>
            </leaf>
            <leaf name="address">
              <type name="string">
                <configd:syntax executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/destination/address/configd_syntax1.cli"/>
                <configd:syntax executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/destination/address/configd_syntax2.cli"/>
              </type>
              <configd:help text="Destination IP address, subnet, or address-group"/>
              <configd:validate executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/destination/address/configd_validate1.cli"/>
              <configd:validate executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/destination/address/configd_validate2.cli"/>
              <configd:validate executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/destination/address/configd_validate3.cli"/>
              <configd:validate executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/destination/address/configd_validate4.cli"/>
              <configd:validate executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/destination/address/configd_validate5.cli"/>
            </leaf>
            <leaf name="port">
              <type name="string"/>
              <configd:help text="Destination port or port-group"/>
              <configd:allowed executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/destination/port/configd_allowed.sh"/>
              <configd:validate executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/destination/port/configd_validate1.cli"/>
              <configd:validate executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/destination/port/configd_validate2.cli"/>
            </leaf>
          </container>
          <leaf name="dscp">
            <type name="uint8">
              <range value="0..63"/>
            </type>
            <configd:help text="DSCP value to match in an incoming IP header"/>
          </leaf>
          <leaf name="state">
            <type name="enumeration">
              <enum name="enable"/>
              <enum name="disable"/>
            </type>
            <configd:help text="Enable or disable state firewall rule"/>
          </leaf>
          <leaf name="protocol">
            <type name="string">
              <configd:syntax executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/protocol/configd_syntax1.cli"/>
              <configd:syntax executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/protocol/configd_syntax2.cli"/>
            </type>
            <configd:help text="Protocol to match (name or number)"/>
            <configd:allowed executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/protocol/configd_allowed.sh"/>
          </leaf>
          <leaf name="ethertype">
            <type name="string">
              <configd:syntax executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/ethertype/configd_syntax.cli"/>
            </type>
            <configd:help text="Ethertype to match (name or hex or decimal)"/>
            <configd:allowed executable="/opt/vyatta/share/tmplscripts/security/firewall/name/rule/ethertype/configd_allowed.sh"/>
          </leaf>
        </list>
        <leaf name="default-action">
          <type name="enumeration">
            <enum name="drop">
              <configd:help text="Drop if no prior rules are hit"/>
            </enum>
            <enum name="accept">
              <configd:help text="Accept if no prior rules are hit"/>
            </enum>
          </type>
          <configd:help text="Default-action for rule-set"/>
          <configd:end executable="/opt/vyatta/share/tmplscripts/security/firewall/name/default-action/configd_end.sh"/>
        </leaf>
        <leaf name="default-log">
          <type name="empty"/>
          <configd:help text="Default-log for rule-set"/>
          <configd:end executable="/opt/vyatta/share/tmplscripts/security/firewall/name/default-log/configd_end.sh"/>
        </leaf>
      </list>
      <container name="session-log">
        <presence value="true"/>
        <configd:help text="Session logging"/>
        <container name="tcp">
          <presence value="true"/>
          <configd:help text="TCP"/>
          <leaf name="close-wait">
            <type name="empty"/>
            <configd:help text="close-wait state"/>
            <configd:end executable="/opt/vyatta/share/tmplscripts/security/firewall/session-log/tcp/close-wait/configd_end.sh"/>
          </leaf>
          <leaf name="established">
            <type name="empty"/>
            <configd:help text="established state"/>
            <configd:end executable="/opt/vyatta/share/tmplscripts/security/firewall/session-log/tcp/established/configd_end.sh"/>
          </leaf>
          <leaf name="syn-sent">
            <type name="empty"/>
            <configd:help text="syn-sent state"/>
            <configd:end executable="/opt/vyatta/share/tmplscripts/security/firewall/session-log/tcp/syn-sent/configd_end.sh"/>
          </leaf>
          <leaf name="fin-received">
            <type name="empty"/>
            <configd:help text="fin-received state"/>
            <configd:end executable="/opt/vyatta/share/tmplscripts/security/firewall/session-log/tcp/fin-received/configd_end.sh"/>
          </leaf>
          <leaf name="fin-sent">
            <type name="empty"/>
            <configd:help text="fin-sent state"/>
            <configd:end executable="/opt/vyatta/share/tmplscripts/security/firewall/session-log/tcp/fin-sent/configd_end.sh"/>
          </leaf>
          <leaf name="closing">
            <type name="empty"/>
            <configd:help text="closing state"/>
            <configd:end executable="/opt/vyatta/share/tmplscripts/security/firewall/session-log/tcp/closing/configd_end.sh"/>
          </leaf>
          <leaf name="simsyn-sent">
            <type name="empty"/>
            <configd:help text="simsyn-sent state"/>
            <configd:end executable="/opt/vyatta/share/tmplscripts/security/firewall/session-log/tcp/simsyn-sent/configd_end.sh"/>
          </leaf>
          <leaf name="time-wait">
            <type name="empty"/>
            <configd:help text="time-wait state"/>
            <configd:end executable="/opt/vyatta/share/tmplscripts/security/firewall/session-log/tcp/time-wait/configd_end.sh"/>
          </leaf>
          <leaf name="last-ack">
            <type name="empty"/>
            <configd:help text="last-ack state"/>
            <configd:end executable="/opt/vyatta/share/tmplscripts/security/firewall/session-log/tcp/last-ack/configd_end.sh"/>
          </leaf>
          <leaf name="syn-received">
            <type name="empty"/>
            <configd:help text="syn-received state"/>
            <configd:end executable="/opt/vyatta/share/tmplscripts/security/firewall/session-log/tcp/syn-received/configd_end.sh"/>
          </leaf>
          <leaf name="fin-wait">
            <type name="empty"/>
            <configd:help text="fin-wait state"/>
            <configd:end executable="/opt/vyatta/share/tmplscripts/security/firewall/session-log/tcp/fin-wait/configd_end.sh"/>
          </leaf>
          <leaf name="timeout">
            <type name="empty"/>
            <configd:help text="time-out state"/>
            <configd:end executable="/opt/vyatta/share/tmplscripts/security/firewall/session-log/tcp/timeout/configd_end.sh"/>
          </leaf>
        </container>
        <container name="icmp">
          <presence value="true"/>
          <configd:help text="ICMP"/>
          <leaf name="established">
            <type name="empty"/>
            <configd:help text="established state"/>
            <configd:end executable="/opt/vyatta/share/tmplscripts/security/firewall/session-log/icmp/established/configd_end.sh"/>
          </leaf>
          <leaf name="closed">
            <type name="empty"/>
            <configd:help text="closed state"/>
            <configd:end executable="/opt/vyatta/share/tmplscripts/security/firewall/session-log/icmp/closed/configd_end.sh"/>
          </leaf>
          <leaf name="timeout">
            <type name="empty"/>
            <configd:help text="timeout state"/>
            <configd:end executable="/opt/vyatta/share/tmplscripts/security/firewall/session-log/icmp/timeout/configd_end.sh"/>
          </leaf>
          <leaf name="new">
            <type name="empty"/>
            <configd:help text="new state"/>
            <configd:end executable="/opt/vyatta/share/tmplscripts/security/firewall/session-log/icmp/new/configd_end.sh"/>
          </leaf>
        </container>
        <container name="other">
          <presence value="true"/>
          <configd:help text="protocols other than TCP, UDP or ICMP"/>
          <leaf name="established">
            <type name="empty"/>
            <configd:help text="established state"/>
            <configd:end executable="/opt/vyatta/share/tmplscripts/security/firewall/session-log/other/established/configd_end.sh"/>
          </leaf>
          <leaf name="closed">
            <type name="empty"/>
            <configd:help text="closed state"/>
            <configd:end executable="/opt/vyatta/share/tmplscripts/security/firewall/session-log/other/closed/configd_end.sh"/>
          </leaf>
          <leaf name="timeout">
            <type name="empty"/>
            <configd:help text="timeout state"/>
            <configd:end executable="/opt/vyatta/share/tmplscripts/security/firewall/session-log/other/timeout/configd_end.sh"/>
          </leaf>
          <leaf name="new">
            <type name="empty"/>
            <configd:help text="new state"/>
            <configd:end executable="/opt/vyatta/share/tmplscripts/security/firewall/session-log/other/new/configd_end.sh"/>
          </leaf>
        </container>
        <container name="udp">
          <presence value="true"/>
          <configd:help text="UDP"/>
          <leaf name="established">
            <type name="empty"/>
            <configd:help text="established state"/>
            <configd:end executable="/opt/vyatta/share/tmplscripts/security/firewall/session-log/udp/established/configd_end.sh"/>
          </leaf>
          <leaf name="closed">
            <type name="empty"/>
            <configd:help text="closed state"/>
            <configd:end executable="/opt/vyatta/share/tmplscripts/security/firewall/session-log/udp/closed/configd_end.sh"/>
          </leaf>
          <leaf name="timeout">
            <type name="empty"/>
            <configd:help text="timeout state"/>
            <configd:end executable="/opt/vyatta/share/tmplscripts/security/firewall/session-log/udp/timeout/configd_end.sh"/>
          </leaf>
          <leaf name="new">
            <type name="empty"/>
            <configd:help text="new state"/>
            <configd:end executable="/opt/vyatta/share/tmplscripts/security/firewall/session-log/udp/new/configd_end.sh"/>
          </leaf>
        </container>
      </container>
      <container name="global-state-policy">
        <presence value="true"/>
        <configd:help text="Configure global state parameters for firewall"/>
        <configd:end executable="/opt/vyatta/share/tmplscripts/security/firewall/global-state-policy/configd_end.sh"/>
        <configd:validate executable="/opt/vyatta/share/tmplscripts/security/firewall/global-state-policy/configd_validate1.cli"/>
        <leaf name="tcp">
          <type name="empty"/>
          <configd:help text="enable tcp state monitoring for firewall"/>
        </leaf>
        <leaf name="icmp">
          <type name="empty"/>
          <configd:help text="enable icmp state monitoring for firewall"/>
        </leaf>
        <leaf name="udp">
          <type name="empty"/>
          <configd:help text="enable udp state monitoring for firewall"/>
        </leaf>
      </container>
      <leaf name="config-trap">
        <type name="enumeration">
          <enum name="enable">
            <configd:help text="Enable sending SNMP trap on firewall configuration change"/>
          </enum>
          <enum name="disable">
            <configd:help text="Disable sending SNMP trap on firewall configuration change"/>
          </enum>
        </type>
        <configd:help text="SNMP trap generation on firewall configuration changes"/>
        <default value="disable"/>
      </leaf>
    </container>
    <container name="zone-policy">
      <presence value="true"/>
      <configd:priority priority="350"/>
      <configd:help text="Zone-policy"/>
      <configd:end executable="/opt/vyatta/share/tmplscripts/security/zone-policy/configd_end.sh"/>
      <list name="zone">
        <configd:help text="Zone name"/>
        <configd:end executable="/opt/vyatta/share/tmplscripts/security/zone-policy/zone/configd_end.sh"/>
        <configd:validate executable="/opt/vyatta/share/tmplscripts/security/zone-policy/zone/configd_validate1.cli"/>
        <configd:validate executable="/opt/vyatta/share/tmplscripts/security/zone-policy/zone/configd_validate2.cli"/>
        <configd:validate executable="/opt/vyatta/share/tmplscripts/security/zone-policy/zone/configd_validate3.cli"/>
        <key value="tagnode"/>
        <leaf name="tagnode">
          <type name="string">
            <pattern value="[0-9A-Za-z][-_0-9A-Za-z]*">
              <error-message>
                <value>only alpha-numeric policy name allowed</value>
              </error-message>
            </pattern>
          </type>
          <configd:help text="Zone name"/>
        </leaf>
        <leaf name="description">
          <type name="string"/>
          <configd:help text="Zone description"/>
        </leaf>
        <leaf-list name="interface">
          <type name="string">
            <configd:syntax executable="/opt/vyatta/share/tmplscripts/security/zone-policy/zone/interface/configd_syntax1.cli"/>
          </type>
          <ordered-by value="user"/>
          <configd:help text="Interface associated with zone"/>
          <configd:allowed executable="/opt/vyatta/share/tmplscripts/security/zone-policy/zone/interface/configd_allowed.sh"/>
          <configd:validate executable="/opt/vyatta/share/tmplscripts/security/zone-policy/zone/interface/configd_validate0.sh"/>
        </leaf-list>
        <leaf name="default-action">
          <type name="enumeration">
            <enum name="accept"/>
            <enum name="drop"/>
          </type>
          <configd:help text="Default-action for traffic leaving this zone"/>
          <default value="drop"/>
        </leaf>
        <list name="to">
          <configd:help text="Output zone to filter traffic"/>
          <configd:allowed executable="/opt/vyatta/share/tmplscripts/security/zone-policy/zone/to/configd_allowed.sh"/>
          <configd:validate executable="/opt/vyatta/share/tmplscripts/security/zone-policy/zone/to/configd_validate1.cli"/>
          <configd:validate executable="/opt/vyatta/share/tmplscripts/security/zone-policy/zone/to/configd_validate2.cli"/>
          <key value="tagnode"/>
          <leaf name="tagnode">
            <type name="string">
              <pattern value="[0-9A-Za-z][-_0-9A-Za-z]*">
                <error-message>
                  <value>only alpha-numeric policy name allowed</value>
                </error-message>
              </pattern>
            </type>
            <configd:help text="Output zone to filter traffic"/>
            <configd:allowed executable="/opt/vyatta/share/tmplscripts/security/zone-policy/zone/to/configd_allowed.sh"/>
          </leaf>
          <leaf-list name="firewall">
            <type name="string">
              <pattern value="[0-9A-Za-z][-_0-9A-Za-z]*">
                <error-message>
                  <value>only alpha-numeric policy name allowed</value>
                </error-message>
              </pattern>
            </type>
            <ordered-by value="user"/>
            <configd:help text="Ruleset for forwarded packets on inbound interface"/>
            <configd:allowed executable="/opt/vyatta/share/tmplscripts/security/zone-policy/zone/to/firewall/configd_allowed.sh"/>
            <configd:validate executable="/opt/vyatta/share/tmplscripts/security/zone-policy/zone/to/firewall/configd_validate1.cli"/>
          </leaf-list>
        </list>
      </list>
    </container>
  </augment>
  <augment target-node="/if:interfaces/interfaces-bridge:bridge">
    <container name="firewall">
      <presence value="true"/>
      <configd:help text="Firewall options"/>
      <configd:end executable="/opt/vyatta/share/tmplscripts/interfaces/bridge/firewall/configd_end.sh"/>
      <configd:validate executable="/opt/vyatta/share/tmplscripts/interfaces/bridge/firewall/configd_validate1.cli"/>
      <configd:validate executable="/opt/vyatta/share/tmplscripts/interfaces/bridge/firewall/configd_validate2.cli"/>
      <leaf-list name="out">
        <type name="string">
          <pattern value="[0-9A-Za-z][-_0-9A-Za-z]*">
            <error-message>
              <value>only alpha-numeric policy name allowed</value>
            </error-message>
          </pattern>
        </type>
        <ordered-by value="user"/>
        <configd:help text="Ruleset for forwarded packets on outbound interface"/>
        <configd:allowed executable="/opt/vyatta/share/tmplscripts/interfaces/bridge/firewall/out/configd_allowed.sh"/>
        <configd:validate executable="/opt/vyatta/share/tmplscripts/interfaces/bridge/firewall/out/configd_validate1.cli"/>
      </leaf-list>
      <leaf-list name="in">
        <type name="string">
          <pattern value="[0-9A-Za-z][-_0-9A-Za-z]*">
            <error-message>
              <value>only alpha-numeric policy name allowed</value>
            </error-message>
          </pattern>
        </type>
        <ordered-by value="user"/>
        <configd:help text="Ruleset for forwarded packets on inbound interface"/>
        <configd:allowed executable="/opt/vyatta/share/tmplscripts/interfaces/bridge/firewall/in/configd_allowed.sh"/>
        <configd:validate executable="/opt/vyatta/share/tmplscripts/interfaces/bridge/firewall/in/configd_validate1.cli"/>
      </leaf-list>
      <leaf-list name="l2">
        <type name="string">
          <pattern value="[0-9A-Za-z][-_0-9A-Za-z]*">
            <error-message>
              <value>only alpha-numeric policy name allowed</value>
            </error-message>
          </pattern>
        </type>
        <ordered-by value="user"/>
        <configd:help text="Ruleset for forwarded packets on bridge interface"/>
        <configd:allowed executable="/opt/vyatta/share/tmplscripts/interfaces/bridge/firewall/l2/configd_allowed.sh"/>
        <configd:validate executable="/opt/vyatta/share/tmplscripts/interfaces/bridge/firewall/l2/configd_validate1.cli"/>
      </leaf-list>
    </container>
  </augment>
  <augment target-node="/if:interfaces/interfaces-dataplane:dataplane">
    <container name="firewall">
      <presence value="true"/>
      <configd:help text="Firewall options"/>
      <configd:end executable="/opt/vyatta/share/tmplscripts/interfaces/dataplane/firewall/configd_end.sh"/>
      <configd:validate executable="/opt/vyatta/share/tmplscripts/interfaces/dataplane/firewall/configd_validate1.cli"/>
      <configd:validate executable="/opt/vyatta/share/tmplscripts/interfaces/dataplane/firewall/configd_validate2.cli"/>
      <leaf-list name="out">
        <type name="string">
          <pattern value="[0-9A-Za-z][-_0-9A-Za-z]*">
            <error-message>
              <value>only alpha-numeric policy name allowed</value>
            </error-message>
          </pattern>
        </type>
        <ordered-by value="user"/>
        <configd:help text="Ruleset for forwarded packets on outbound interface"/>
        <configd:allowed executable="/opt/vyatta/share/tmplscripts/interfaces/dataplane/firewall/out/configd_allowed.sh"/>
        <configd:validate executable="/opt/vyatta/share/tmplscripts/interfaces/dataplane/firewall/out/configd_validate1.cli"/>
      </leaf-list>
      <leaf-list name="in">
        <type name="string">
          <pattern value="[0-9A-Za-z][-_0-9A-Za-z]*">
            <error-message>
              <value>only alpha-numeric policy name allowed</value>
            </error-message>
          </pattern>
        </type>
        <ordered-by value="user"/>
        <configd:help text="Ruleset for forwarded packets on inbound interface"/>
        <configd:allowed executable="/opt/vyatta/share/tmplscripts/interfaces/dataplane/firewall/in/configd_allowed.sh"/>
        <configd:validate executable="/opt/vyatta/share/tmplscripts/interfaces/dataplane/firewall/in/configd_validate1.cli"/>
      </leaf-list>
    </container>
  </augment>
  <augment target-node="/if:interfaces/interfaces-dataplane:dataplane/interfaces-dataplane:vif">
    <container name="firewall">
      <presence value="true"/>
      <configd:help text="Firewall options"/>
      <configd:end executable="/opt/vyatta/share/tmplscripts/interfaces/dataplane/vif/firewall/configd_end.sh"/>
      <configd:validate executable="/opt/vyatta/share/tmplscripts/interfaces/dataplane/vif/firewall/configd_validate1.cli"/>
      <configd:validate executable="/opt/vyatta/share/tmplscripts/interfaces/dataplane/vif/firewall/configd_validate2.cli"/>
      <leaf-list name="out">
        <type name="string">
          <pattern value="[0-9A-Za-z][-_0-9A-Za-z]*">
            <error-message>
              <value>only alpha-numeric policy name allowed</value>
            </error-message>
          </pattern>
        </type>
        <ordered-by value="user"/>
        <configd:help text="Ruleset for forwarded packets on outbound interface"/>
        <configd:allowed executable="/opt/vyatta/share/tmplscripts/interfaces/dataplane/vif/firewall/out/configd_allowed.sh"/>
        <configd:validate executable="/opt/vyatta/share/tmplscripts/interfaces/dataplane/vif/firewall/out/configd_validate1.cli"/>
      </leaf-list>
      <leaf-list name="in">
        <type name="string">
          <pattern value="[0-9A-Za-z][-_0-9A-Za-z]*">
            <error-message>
              <value>only alpha-numeric policy name allowed</value>
            </error-message>
          </pattern>
        </type>
        <ordered-by value="user"/>
        <configd:help text="Ruleset for forwarded packets on inbound interface"/>
        <configd:allowed executable="/opt/vyatta/share/tmplscripts/interfaces/dataplane/vif/firewall/in/configd_allowed.sh"/>
        <configd:validate executable="/opt/vyatta/share/tmplscripts/interfaces/dataplane/vif/firewall/in/configd_validate1.cli"/>
      </leaf-list>
    </container>
  </augment>
  <augment target-node="/if:interfaces/interfaces-l2tpeth:l2tpeth">
    <container name="firewall">
      <presence value="true"/>
      <configd:help text="Firewall options"/>
      <configd:end executable="/opt/vyatta/share/tmplscripts/interfaces/l2tpeth/firewall/configd_end.sh"/>
      <configd:validate executable="/opt/vyatta/share/tmplscripts/interfaces/l2tpeth/firewall/configd_validate1.cli"/>
      <configd:validate executable="/opt/vyatta/share/tmplscripts/interfaces/l2tpeth/firewall/configd_validate2.cli"/>
      <leaf-list name="out">
        <type name="string">
          <pattern value="[0-9A-Za-z][-_0-9A-Za-z]*">
            <error-message>
              <value>only alpha-numeric policy name allowed</value>
            </error-message>
          </pattern>
        </type>
        <ordered-by value="user"/>
        <configd:help text="Ruleset for forwarded packets on outbound interface"/>
        <configd:allowed executable="/opt/vyatta/share/tmplscripts/interfaces/l2tpeth/firewall/out/configd_allowed.sh"/>
        <configd:validate executable="/opt/vyatta/share/tmplscripts/interfaces/l2tpeth/firewall/out/configd_validate1.cli"/>
      </leaf-list>
      <leaf-list name="in">
        <type name="string">
          <pattern value="[0-9A-Za-z][-_0-9A-Za-z]*">
            <error-message>
              <value>only alpha-numeric policy name allowed</value>
            </error-message>
          </pattern>
        </type>
        <ordered-by value="user"/>
        <configd:help text="Ruleset for forwarded packets on inbound interface"/>
        <configd:allowed executable="/opt/vyatta/share/tmplscripts/interfaces/l2tpeth/firewall/in/configd_allowed.sh"/>
        <configd:validate executable="/opt/vyatta/share/tmplscripts/interfaces/l2tpeth/firewall/in/configd_validate1.cli"/>
      </leaf-list>
    </container>
  </augment>
  <augment target-node="/if:interfaces/interfaces-l2tpeth:l2tpeth/interfaces-l2tpeth:vif">
    <container name="firewall">
      <presence value="true"/>
      <configd:help text="Firewall options"/>
      <configd:end executable="/opt/vyatta/share/tmplscripts/interfaces/l2tpeth/vif/firewall/configd_end.sh"/>
      <configd:validate executable="/opt/vyatta/share/tmplscripts/interfaces/l2tpeth/vif/firewall/configd_validate1.cli"/>
      <configd:validate executable="/opt/vyatta/share/tmplscripts/interfaces/l2tpeth/vif/firewall/configd_validate2.cli"/>
      <leaf-list name="out">
        <type name="string">
          <pattern value="[0-9A-Za-z][-_0-9A-Za-z]*">
            <error-message>
              <value>only alpha-numeric policy name allowed</value>
            </error-message>
          </pattern>
        </type>
        <ordered-by value="user"/>
        <configd:help text="Ruleset for forwarded packets on outbound interface"/>
        <configd:allowed executable="/opt/vyatta/share/tmplscripts/interfaces/l2tpeth/vif/firewall/out/configd_allowed.sh"/>
        <configd:validate executable="/opt/vyatta/share/tmplscripts/interfaces/l2tpeth/vif/firewall/out/configd_validate1.cli"/>
      </leaf-list>
      <leaf-list name="in">
        <type name="string">
          <pattern value="[0-9A-Za-z][-_0-9A-Za-z]*">
            <error-message>
              <value>only alpha-numeric policy name allowed</value>
            </error-message>
          </pattern>
        </type>
        <ordered-by value="user"/>
        <configd:help text="Ruleset for forwarded packets on inbound interface"/>
        <configd:allowed executable="/opt/vyatta/share/tmplscripts/interfaces/l2tpeth/vif/firewall/in/configd_allowed.sh"/>
        <configd:validate executable="/opt/vyatta/share/tmplscripts/interfaces/l2tpeth/vif/firewall/in/configd_validate1.cli"/>
      </leaf-list>
    </container>
  </augment>
  <augment target-node="/if:interfaces/interfaces-openvpn:openvpn">
    <container name="firewall">
      <presence value="true"/>
      <configd:help text="Firewall options"/>
      <configd:end executable="/opt/vyatta/share/tmplscripts/interfaces/openvpn/firewall/configd_end.sh"/>
      <configd:validate executable="/opt/vyatta/share/tmplscripts/interfaces/openvpn/firewall/configd_validate1.cli"/>
      <configd:validate executable="/opt/vyatta/share/tmplscripts/interfaces/openvpn/firewall/configd_validate2.cli"/>
      <leaf-list name="out">
        <type name="string">
          <pattern value="[0-9A-Za-z][-_0-9A-Za-z]*">
            <error-message>
              <value>only alpha-numeric policy name allowed</value>
            </error-message>
          </pattern>
        </type>
        <ordered-by value="user"/>
        <configd:help text="Ruleset for forwarded packets on outbound interface"/>
        <configd:allowed executable="/opt/vyatta/share/tmplscripts/interfaces/openvpn/firewall/out/configd_allowed.sh"/>
        <configd:validate executable="/opt/vyatta/share/tmplscripts/interfaces/openvpn/firewall/out/configd_validate1.cli"/>
      </leaf-list>
      <leaf-list name="in">
        <type name="string">
          <pattern value="[0-9A-Za-z][-_0-9A-Za-z]*">
            <error-message>
              <value>only alpha-numeric policy name allowed</value>
            </error-message>
          </pattern>
        </type>
        <ordered-by value="user"/>
        <configd:help text="Ruleset for forwarded packets on inbound interface"/>
        <configd:allowed executable="/opt/vyatta/share/tmplscripts/interfaces/openvpn/firewall/in/configd_allowed.sh"/>
        <configd:validate executable="/opt/vyatta/share/tmplscripts/interfaces/openvpn/firewall/in/configd_validate1.cli"/>
      </leaf-list>
    </container>
  </augment>
  <augment target-node="/if:interfaces/interfaces-tunnel:tunnel">
    <container name="firewall">
      <presence value="true"/>
      <configd:help text="Firewall options"/>
      <configd:end executable="/opt/vyatta/share/tmplscripts/interfaces/tunnel/firewall/configd_end.sh"/>
      <configd:validate executable="/opt/vyatta/share/tmplscripts/interfaces/tunnel/firewall/configd_validate1.cli"/>
      <configd:validate executable="/opt/vyatta/share/tmplscripts/interfaces/tunnel/firewall/configd_validate2.cli"/>
      <leaf-list name="out">
        <type name="string">
          <pattern value="[0-9A-Za-z][-_0-9A-Za-z]*">
            <error-message>
              <value>only alpha-numeric policy name allowed</value>
            </error-message>
          </pattern>
        </type>
        <ordered-by value="user"/>
        <configd:help text="Ruleset for forwarded packets on outbound interface"/>
        <configd:allowed executable="/opt/vyatta/share/tmplscripts/interfaces/tunnel/firewall/out/configd_allowed.sh"/>
        <configd:validate executable="/opt/vyatta/share/tmplscripts/interfaces/tunnel/firewall/out/configd_validate1.cli"/>
      </leaf-list>
      <leaf-list name="in">
        <type name="string">
          <pattern value="[0-9A-Za-z][-_0-9A-Za-z]*">
            <error-message>
              <value>only alpha-numeric policy name allowed</value>
            </error-message>
          </pattern>
        </type>
        <ordered-by value="user"/>
        <configd:help text="Ruleset for forwarded packets on inbound interface"/>
        <configd:allowed executable="/opt/vyatta/share/tmplscripts/interfaces/tunnel/firewall/in/configd_allowed.sh"/>
        <configd:validate executable="/opt/vyatta/share/tmplscripts/interfaces/tunnel/firewall/in/configd_validate1.cli"/>
      </leaf-list>
    </container>
  </augment>
  <augment target-node="/if:interfaces/interfaces-vti:vti">
    <container name="firewall">
      <presence value="true"/>
      <configd:help text="Firewall options"/>
      <configd:end executable="/opt/vyatta/share/tmplscripts/interfaces/vti/firewall/configd_end.sh"/>
      <configd:validate executable="/opt/vyatta/share/tmplscripts/interfaces/vti/firewall/configd_validate1.cli"/>
      <configd:validate executable="/opt/vyatta/share/tmplscripts/interfaces/vti/firewall/configd_validate2.cli"/>
      <leaf-list name="out">
        <type name="string">
          <pattern value="[0-9A-Za-z][-_0-9A-Za-z]*">
            <error-message>
              <value>only alpha-numeric policy name allowed</value>
            </error-message>
          </pattern>
        </type>
        <ordered-by value="user"/>
        <configd:help text="Ruleset for forwarded packets on outbound interface"/>
        <configd:allowed executable="/opt/vyatta/share/tmplscripts/interfaces/vti/firewall/out/configd_allowed.sh"/>
        <configd:validate executable="/opt/vyatta/share/tmplscripts/interfaces/vti/firewall/out/configd_validate1.cli"/>
      </leaf-list>
      <leaf-list name="in">
        <type name="string">
          <pattern value="[0-9A-Za-z][-_0-9A-Za-z]*">
            <error-message>
              <value>only alpha-numeric policy name allowed</value>
            </error-message>
          </pattern>
        </type>
        <ordered-by value="user"/>
        <configd:help text="Ruleset for forwarded packets on inbound interface"/>
        <configd:allowed executable="/opt/vyatta/share/tmplscripts/interfaces/vti/firewall/in/configd_allowed.sh"/>
        <configd:validate executable="/opt/vyatta/share/tmplscripts/interfaces/vti/firewall/in/configd_validate1.cli"/>
      </leaf-list>
    </container>
  </augment>
</module>
